{"completion": "\"[{\\\"processed_boxes\\\":[{\\\"order_number\\\":\\\"1692\\\",\\\"symbol\\\":\\\"IDE CR J-CH\\\",\\\"quantity\\\":2000,\\\"output\\\":2,\\\"hierarchy\\\":\\\"priority\\\",\\\"total_weight\\\":184,\\\"part\\\":1,\\\"remaining\\\":0,\\\"arapack_lot\\\":\\\"25281\\\"},{\\\"authorized_refile\\\":false}],\\\"sheet\\\":\\\"67ddbee6a331fd508605b12d\\\",\\\"scheduled_date\\\":\\\"2025-03-27\\\",\\\"start_time\\\":\\\"08:20\\\",\\\"end_time\\\":\\\"08:47\\\",\\\"refile\\\":7.2,\\\"grams_per_m2\\\":354,\\\"linear_meters\\\":1578,\\\"speed\\\":60},{\\\"processed_boxes\\\":[{\\\"order_number\\\":\\\"3023775\\\",\\\"symbol\\\":\\\"SEPARADOR 5\\\",\\\"quantity\\\":30000,\\\"output\\\":4,\\\"hierarchy\\\":\\\"priority\\\",\\\"total_weight\\\":2654,\\\"part\\\":1,\\\"remaining\\\":0,\\\"arapack_lot\\\":\\\"25318\\\"},{\\\"authorized_refile\\\":false}],\\\"sheet\\\":\\\"67ddbee6a331fd508605b134\\\",\\\"scheduled_date\\\":\\\"2025-03-27\\\",\\\"start_time\\\":\\\"08:47\\\",\\\"end_time\\\":\\\"11:20\\\",\\\"refile\\\":4,\\\"grams_per_m2\\\":350,\\\"linear_meters\\\":9075,\\\"speed\\\":60},{\\\"processed_boxes\\\":[{\\\"order_number\\\":\\\"120257111659\\\",\\\"symbol\\\":\\\"GTP SEP RAYADO 88X36\\\",\\\"quantity\\\":1500,\\\"output\\\":1,\\\"hierarchy\\\":\\\"priority\\\",\\\"total_weight\\\":337,\\\"part\\\":1,\\\"remaining\\\":0,\\\"arapack_lot\\\":\\\"25284\\\"},{\\\"order_number\\\":\\\"3023741\\\",\\\"symbol\\\":\\\"SEPARADOR 1\\\",\\\"quantity\\\":983,\\\"output\\\":1,\\\"hierarchy\\\":\\\"complement\\\",\\\"total_weight\\\":76,\\\"part\\\":1,\\\"remaining\\\":2817,\\\"arapack_lot\\\":\\\"25295\\\"},{\\\"authorized_refile\\\":false}],\\\"sheet\\\":\\\"67ddbee6a331fd508605b13d\\\",\\\"scheduled_date\\\":\\\"2025-03-27\\\",\\\"start_time\\\":\\\"11:20\\\",\\\"end_time\\\":\\\"11:40\\\",\\\"refile\\\":4.0,\\\"grams_per_m2\\\":345,\\\"linear_meters\\\":1110,\\\"speed\\\":60},{\\\"processed_boxes\\\":[{\\\"order_number\\\":\\\"3023741\\\",\\\"symbol\\\":\\\"SEPARADOR 1\\\",\\\"quantity\\\":2817,\\\"output\\\":4,\\\"hierarchy\\\":\\\"priority\\\",\\\"total_weight\\\":219,\\\"part\\\":2,\\\"remaining\\\":0,\\\"arapack_lot\\\":\\\"25295\\\"},{\\\"authorized_refile\\\":true}],\\\"sheet\\\":\\\"67ddbee6a331fd508605b130\\\",\\\"scheduled_date\\\":\\\"2025-03-27\\\",\\\"start_time\\\":\\\"11:40\\\",\\\"end_time\\\":\\\"12:35\\\",\\\"refile\\\":14,\\\"grams_per_m2\\\":345,\\\"linear_meters\\\":3183,\\\"speed\\\":60}]\"\n}]", "prompt": "You are an expert in production planning. Your task is to create an optimized schedule that maximizes resource usage, minimizes waste (refile), and meets delivery deadlines. Follow the business rules strictly. Context: The machine can process between one and two types of boxes per run. The objective is to maximize sheet usage and ensure all orders are completed before their delivery date. Prioritize orders based on delivery date and quantity. Rules: 1) Corrugator Run: Process up to two box types per run. The allowed refile is between 4 cm and 8 cm. If a box is associated with a sheet, it means it fits perfectly on that sheet, so it does not need to be combined with another box, or preferably should not be combined with another. In some cases, there may be duplication of the same box on a sheet. If a sheet has no associated boxes, it can combine up to two compatible boxes. The runs could have 2 different boxes, one will be the priority (the purchase with the highest quantity ordered) and the other one will be the complement, the complement must be matched with the priority's linear_meters so, to calculate the complementary pieces: complementary_quantity = ((priority_quantity * priority_box_length / priority_output_box)) / (complementary_box_length * complementary_output_box). 2) Box Compatibility: Two boxes can be combined in the same run if they share the same ECT and liner. The anti-humidity treatment is not an inherent property of the lamina but is applied to the entire run. This means that the same lamina can be used for different runs with different anti-humidity treatments, as long as within each run the boxes require the same treatment. Incompatible boxes (those with different ECT or liner) cannot be combined on the same sheet. 3) Refile Calculation: Calculate refile as: roll_width - (sum of box widths * box output per sheet). Ensure the refile is within 4 to 8. If the refile exceeds limits do an adjustment and if no adjustment is possible, schedule the box alone and mark it with 'authorized_refile': true. 4) Production Calculations: output_box: Number of times a box fits into the sheet width. Example: if the box width is 50 and the sheet is 105 wide, output_box = 2, leaving a 5 as refile. the exact formula is: floor(roll_width / box_width). linear_meters: ((purchase_quantity * box_length / 100) / output_box). Production time: round(linear_meters / 60) the result is handled as minutes. Total weight: linear_meters * sheet_grams / 1000. Ensure there are no discrepancies between calculated values. 5) Scheduling: Respect working hours: Monday: 08:20–18:00, Tuesday to Thursday: 08:20–22:30, Friday: 08:20–17:30. Fill the available time before moving to the next day. Runs must be continuous without dead time. If a run exceeds the day's available time, continue on the next working day without interruption. If all days are full, continue scheduling into the next week. 6) Prioritization of Orders: Select the purchase with the earliest estimated_delivery_date as the priority. 7) Validation Rules: Ensure the sum of box widths plus refile does not exceed the sheet width. The refile must strictly remain between 4 cm and 8 cm. Start and end times should reflect the exact production time and align with working hours. Verify that all calculations match the results in the output. Maintain consistency in the refile, production time, and scheduling. Data Input: The following dynamic data will be provided: Sheets: ECT, width, identifier, grams, and associated boxes. Boxes: ECT, width, length, liner, flute, anti-humidity treatment and identifier as symbol. purchases: order_number, array of boxes with the identifier as symbol and the ordered quantity, arapack_lote (an unique id for the factory), and the estimated_delivery_date. Use this data to generate the plan, following all rules and ensuring accurate calculations. Expected output, Respond with a JSON structured as follows, with no extra text like this: {\\\"processed_boxes\\\":[{\\\"order_number\\\":\\\"string\\\",\\\"symbol\\\":\\\"string\\\",\\\"quantity\\\":1,\\\"output\\\":1,\\\"hierarchy\\\":\\\"string\\\",\\\"part\\\":1,\\\"remaining\\\":1},{\\\"order_number\\\":\\\"string\\\",\\\"symbol\\\":\\\"string\\\",\\\"quantity\\\":1,\\\"output\\\":1,\\\"hierarchy\\\":\\\"string\\\",\\\"part\\\":1,\\\"remaining\\\":1},{\\\"authorized_refile\\\":false}],\\\"sheet\\\":\\\"string\\\",\\\"scheduled_date\\\":\\\"date\\\",\\\"start_time\\\":\\\"time\\\",\\\"end_time\\\":\\\"time\\\",\\\"refile\\\":1.0,\\\"grams_per_m2\\\":1,\\\"linear_meters\\\":1,\\\"total_weight\\\":1,\\\"speed\\\":1}   \"{\\\"purchases\\\":[{\\\"order_number\\\":\\\"1692\\\",\\\"symbol\\\":\\\"IDE CR J-CH\\\",\\\"quantity\\\":2000,\\\"flute\\\":\\\"C\\\",\\\"ect\\\":21,\\\"liner\\\":\\\"KRAFT\\\",\\\"type\\\":\\\"CRR\\\",\\\"estimated_delivery_date\\\":\\\"2025-03-28T00:00:00\\\"},{\\\"order_number\\\":\\\"120257111659\\\",\\\"symbol\\\":\\\"GTP SEP RAYADO 88X36\\\",\\\"quantity\\\":1500,\\\"flute\\\":\\\"C\\\",\\\"ect\\\":19,\\\"liner\\\":\\\"KRAFT\\\",\\\"type\\\":\\\"SEP\\\",\\\"estimated_delivery_date\\\":\\\"2025-03-30T00:00:00\\\"},{\\\"order_number\\\":\\\"3023741\\\",\\\"symbol\\\":\\\"SEPARADOR 1\\\",\\\"quantity\\\":3800,\\\"flute\\\":\\\"C\\\",\\\"ect\\\":19,\\\"liner\\\":\\\"KRAFT\\\",\\\"type\\\":\\\"SEP\\\",\\\"estimated_delivery_date\\\":\\\"2025-03-30T00:00:00\\\"},{\\\"order_number\\\":\\\"3023775\\\",\\\"symbol\\\":\\\"SEPARADOR 5\\\",\\\"quantity\\\":30000,\\\"flute\\\":\\\"C\\\",\\\"ect\\\":19,\\\"liner\\\":\\\"KRAFT\\\",\\\"type\\\":\\\"SEP\\\",\\\"estimated_delivery_date\\\":\\\"2025-04-04T00:00:00\\\"}],\\\"boxes\\\":[{\\\"id\\\":\\\"67e337fba331fd508608d428\\\",\\\"symbol\\\":\\\"IDE CR J-CH\\\",\\\"ect\\\":21,\\\"liner\\\":\\\"KRAFT\\\",\\\"width\\\":32.9,\\\"length\\\":78.9,\\\"flute\\\":\\\"C\\\",\\\"treatment\\\":0,\\\"client\\\":\\\"LA IDEAL\\\",\\\"creases\\\":{\\\"r1\\\":9,\\\"r2\\\":14.9,\\\"r3\\\":9},\\\"status\\\":\\\"approved\\\",\\\"type\\\":\\\"CRR\\\",\\\"pdf_link\\\":\\\"\\\"},{\\\"id\\\":\\\"67e33854a331fd508608d460\\\",\\\"symbol\\\":\\\"SEPARADOR 5\\\",\\\"ect\\\":19,\\\"liner\\\":\\\"KRAFT\\\",\\\"width\\\":21.5,\\\"length\\\":121,\\\"flute\\\":\\\"C\\\",\\\"treatment\\\":0,\\\"client\\\":\\\"GRUPAK (CUERNA)\\\",\\\"creases\\\":{\\\"r1\\\":null,\\\"r2\\\":null,\\\"r3\\\":null},\\\"status\\\":\\\"approved\\\",\\\"type\\\":\\\"SEP\\\",\\\"pdf_link\\\":\\\"\\\"},{\\\"id\\\":\\\"67e33854a331fd508608d45a\\\",\\\"symbol\\\":\\\"SEPARADOR 1\\\",\\\"ect\\\":19,\\\"liner\\\":\\\"KRAFT\\\",\\\"width\\\":18,\\\"length\\\":113,\\\"flute\\\":\\\"C\\\",\\\"treatment\\\":0,\\\"client\\\":\\\"GRUPAK (CUERNA)\\\",\\\"creases\\\":{\\\"r1\\\":null,\\\"r2\\\":null,\\\"r3\\\":null},\\\"status\\\":\\\"approved\\\",\\\"type\\\":\\\"SEP\\\",\\\"pdf_link\\\":\\\"\\\"},{\\\"id\\\":\\\"67e33854a331fd508608d45d\\\",\\\"symbol\\\":\\\"GTP SEP RAYADO 88X36\\\",\\\"ect\\\":19,\\\"liner\\\":\\\"KRAFT\\\",\\\"width\\\":88,\\\"length\\\":74,\\\"flute\\\":\\\"C\\\",\\\"treatment\\\":0,\\\"client\\\":\\\"GRUPO TEXTIL PROVIDENCIA S.A DE C.V (NAVA)\\\",\\\"creases\\\":{\\\"r1\\\":42,\\\"r2\\\":4,\\\"r3\\\":42},\\\"status\\\":\\\"approved\\\",\\\"type\\\":\\\"SEP\\\",\\\"pdf_link\\\":\\\"\\\"}],\\\"sheets\\\":[{\\\"id\\\":\\\"67ddbee6a331fd508605b130\\\",\\\"roll_width\\\":86,\\\"p1\\\":0,\\\"p2\\\":0,\\\"p3\\\":0,\\\"ect\\\":[19],\\\"grams\\\":330,\\\"description\\\":\\\"\\\",\\\"boxes\\\":[]},{\\\"id\\\":\\\"67ddbee6a331fd508605b131\\\",\\\"roll_width\\\":86,\\\"p1\\\":0,\\\"p2\\\":0,\\\"p3\\\":0,\\\"ect\\\":[19,21],\\\"grams\\\":350,\\\"description\\\":\\\"\\\",\\\"boxes\\\":[]},{\\\"id\\\":\\\"67ddbee6a331fd508605b135\\\",\\\"roll_width\\\":125,\\\"p1\\\":0,\\\"p2\\\":0,\\\"p3\\\":0,\\\"ect\\\":[21],\\\"grams\\\":372,\\\"description\\\":\\\"\\\",\\\"boxes\\\":[]},{\\\"id\\\":\\\"67ddbee6a331fd508605b13c\\\",\\\"roll_width\\\":160,\\\"p1\\\":0,\\\"p2\\\":0,\\\"p3\\\":0,\\\"ect\\\":[21,23],\\\"grams\\\":345,\\\"description\\\":\\\"\\\",\\\"boxes\\\":[]},{\\\"id\\\":\\\"67ddbee6a331fd508605b136\\\",\\\"roll_width\\\":115,\\\"p1\\\":0,\\\"p2\\\":0,\\\"p3\\\":0,\\\"ect\\\":[21,23],\\\"grams\\\":345,\\\"description\\\":\\\"\\\",\\\"boxes\\\":[]},{\\\"id\\\":\\\"67ddbee6a331fd508605b139\\\",\\\"roll_width\\\":114,\\\"p1\\\":0,\\\"p2\\\":0,\\\"p3\\\":0,\\\"ect\\\":[21,23],\\\"grams\\\":340,\\\"description\\\":\\\"\\\",\\\"boxes\\\":[]},{\\\"id\\\":\\\"67ddbee6a331fd508605b133\\\",\\\"roll_width\\\":137,\\\"p1\\\":0,\\\"p2\\\":0,\\\"p3\\\":0,\\\"ect\\\":[19],\\\"grams\\\":350,\\\"description\\\":\\\"\\\",\\\"boxes\\\":[]},{\\\"id\\\":\\\"67ddbee6a331fd508605b12d\\\",\\\"roll_width\\\":73,\\\"p1\\\":0,\\\"p2\\\":0,\\\"p3\\\":0,\\\"ect\\\":[19,21],\\\"grams\\\":354,\\\"description\\\":\\\"\\\",\\\"boxes\\\":[]},{\\\"id\\\":\\\"67ddbee6a331fd508605b134\\\",\\\"roll_width\\\":90,\\\"p1\\\":0,\\\"p2\\\":0,\\\"p3\\\":0,\\\"ect\\\":[19],\\\"grams\\\":340,\\\"description\\\":\\\"\\\",\\\"boxes\\\":[]},{\\\"id\\\":\\\"67ddbee6a331fd508605b13d\\\",\\\"roll_width\\\":110,\\\"p1\\\":0,\\\"p2\\\":0,\\\"p3\\\":0,\\\"ect\\\":[19],\\\"grams\\\":345,\\\"description\\\":\\\"\\\",\\\"boxes\\\":[]},{\\\"id\\\":\\\"67eae7036b850a529dab8c8c\\\",\\\"roll_width\\\":133,\\\"p1\\\":110,\\\"p2\\\":110,\\\"p3\\\":110,\\\"ect\\\":[19],\\\"grams\\\":389,\\\"description\\\":\\\"This is a description\\\",\\\"boxes\\\":[\\\"ejemplo\\\"]},{\\\"id\\\":\\\"67eae9356b850a529dab8c8d\\\",\\\"roll_width\\\":145,\\\"p1\\\":19,\\\"p2\\\":22,\\\"p3\\\":22,\\\"ect\\\":[19,22,28],\\\"grams\\\":59,\\\"description\\\":\\\"Prueba de descripcion\\\",\\\"boxes\\\":[\\\"DEG CR CE-10\\\",\\\"GALLETERA CR 15R-M\\\"]}]}\\n\\nUse this data to generate the plan, following all rules and ensuring accurate calculations. Do not use example data in the response. Final Instructions: Return only the JSON. Validate all calculations before providing the final output. Ensure there are no discrepancies between calculated values and the ones shown in the JSON. Maintain consistency in the refile, production time, and scheduling. Remember to return the JSON with the schedule.",
}
{}